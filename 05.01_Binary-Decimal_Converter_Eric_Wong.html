<!DOCTYPE html>
<html>
	<head>
		<style>
			table,
			th,
			td {
				padding: 5px;
				border: 1px solid #000000;
				border-collapse: collapse;
				text-align:center;
				table-layout: fixed;
				width: 20%;
      			}
			
			input {text-align: center;}
    		</style>
	</head>
	<body>
		<h1>05.01 Binary <-> Decimal Converter Eric Wong</h1>
		
		<p>Binary Number:</p>
		<table id = "tblBits">
  			<tr>
				<td>128</td>
				<td>64</td>
				<td>32</td>
				<td>16</td>
				<td>8</td>
				<td>4</td>
				<td>2</td>
				<td>1</td>
				
				<!-- 
					What is the decimal place value of the first bit? 
					Note that we show the bits from right -> left in increasing place value.
					
					Copy and paste the line above 7 times for each of the 8 bits and change the decimal place value.
				-->

				<!-- Explaination:
					The decimal place value of the first bit from left to right is 128.
					However, the first decimal plae value of the first bit from right to left is 1
					
					We have to paste it 7 more times because we need 8 bits to represent from 2^7 (128) to 2^0 (1)
				-->
			</tr>
			<tr>
				<td><input type = "button" id = "btn128" onclick = "convDec(this.id)" value = "0"></td>
				<td><input type = "button" id = "btn64" onclick = "convDec(this.id)" value = "0"></td>
				<td><input type = "button" id = "btn32" onclick = "convDec(this.id)" value = "0"></td>
				<td><input type = "button" id = "btn16" onclick = "convDec(this.id)" value = "0"></td>
				<td><input type = "button" id = "btn8" onclick = "convDec(this.id)" value = "0"></td>
				<td><input type = "button" id = "btn4" onclick = "convDec(this.id)" value = "0"></td>
				<td><input type = "button" id = "btn2" onclick = "convDec(this.id)" value = "0"></td>
				<td><input type = "button" id = "btn1" onclick = "convDec(this.id)" value = "0"></td>
				
				<!-- Copy and paste the line above 7 times for each of the 8 bits and change the id (decimal place value). -->
				
				<!-- Explaination:
					We also have to paste this 7 more times since there are 8 bits that we need to represent.
				-->
			</tr>
		</table>
		<h3>Number In Decimal:</h3>
		<input type = "number" oninput = "convBin()" id = "inpDecNum" min = 0 max = 255 value = "0">
		
		<script>
			function convDec(btn) {
				
				/*
					How do we know the id of the button that has been clicked so we can 
					switch it from 0 -> 1 or 1 -> 0?
					(See the name of variable passed to this function inside (...) of the 
					function header above.)
				*/

				/* Explaination:
					We can get the id of the button by using the "btn" parameter, since the
					id is already included when this function is called in the onclick 
					function of the buttons. (... convDec(this.id) ...)
				*/

				let btnClicked = document.getElementById(btn);
				
				/* 
				We only switch a bit if a button was clicked,
				i.e. If an invalid decimal was entered then we need to return
				the decimal number to whatever the button bits currently represent
				but don't switch any bits. 
				*/

				if (btnClicked != null)
					
					// If the value of the button is ? switch it to a ? else a ?.

					/* Explaination:
						If the value of the button is 0, we have to switch it to a 1
						otherwise, the value of the button must be 1, so we have to
						switch it to 0.

						In this case, we can toggle the button's value between 1 and 0
					*/
					
					if (btnClicked.value == 0)
						btnClicked.value = 1;
					else
						btnClicked.value = 0;
				
				
				// What is the id of the table with all the "binary bit" buttons?
				// Explaination: The id of the table with all the "binary bit" buttons is "tblBits" (line 23)
				let bits = document.getElementById("tblBits").getElementsByTagName('input');
				
				/* 
					The variable below will hold the decimal equivalent of the bits in the table.
					What should it be initialised to?
				*/
				
				/* Explaination:
					The variable should be initlized to 128, because we are 
				*/
				let decNum = 0;
				
				/* 
					The variable below will hold the decimal place value of each bit.
					What is the decimal place value of the first bit?
					Note that we go through all the bits from left -> right.
				*/
				let placeVal = 128;
				
				for (let b of bits){
					
					/* 
						Which variable holds the decimal equivalent of the bits in the table?
						Which variable holds the place value of each bit to multiply by?
					*/
					decNum += b.value * placeVal;
					
					// Which variable needs halving for each "bit"?
					placeVal /= 2;
				}
				
				/* 
					What is the id of the input box which shows the decimal equivalent of the bits in the table?
					Which variable needs to be displayed there?
				*/
				document.getElementById("inpDecNum").value = decNum;
				
			}
			
			function convBin() {
				
				// What is the id of the input box which holds the decimal number to convert to binary?
				let decNum = document.getElementById("inpDecNum").valueAsNumber;
				
				// What is the lowest decimal number that can be represented by 8 bits in this converter?
				if (decNum < 0) {
					alert("This converter does not deal with numbers < 0 !"); // Or "... with ? numbers!"
					convDec(); // Call the convDec() function to reconvert what the bits show.
				}
				
				// What is the highest decimal number that can be represented by 8 bits in this converter?
				else if (decNum > 255) {
					alert("This converter does not deal with numbers > 255 !");
					convDec(); // Convert the binary number currently showing to decimal.
				}
				
				else {
					// What is the id of the table with all the "binary bit" buttons?
					let bits = document.getElementById("tblBits").getElementsByTagName('input');
					
					/* 
						The variable below will hold the place value of each bit.
						What should it be initialised to (note that we go through all the bits from
						left -> right).
					*/
					let placeVal = 128;
					
					for (let b of bits){
						
						// What do we need to check before deciding to use a 0 or 1?
						if (decNum >= placeVal){
							
							// Do we write a 1 or 0?
							b.value = 1;
							
							// What do we subtract from the decimal number?
							decNum -= placeVal;
						}
						else
							// Do we write a 1 or 0?
							b.value = 0;
						
						// What happens to the place value of each bit as we go from left -> right?
						placeVal /= 2;
					}
				}
			}
		</script>
	</body>
</html>

<!--
Notes:
1. When creating button ids use btn to start the id.

2. Use this.id to send the id of the button clicked to a function.
We do this so we can change the button clicked to 1 or 0.

3. When dealing with anything other than number inputs, must use .value, not .valueAsNumber.
document.getElementById('btn128').value * 128

4. There actually 10 inputs:
(the 8 bits (buttons) + decimal number input + another button to convert the decimal number).

Therefore we need to have a way to differentiate between them.
The easiest way is to give the table with the 8 bits an id e.g. tblBinary.
Then use this id to get all the buttons in this id and put them in an array (list).

e.g.
let bits = document.getElementById("tblBinary").getElementsByTagName('input');

We can refer to each button with a loop which goes through each button
(the first one is the bit for 128 and the last one the bit for 1).

e.g.
for (let b of bits){
	if (decNum >= placeVal)
		b.value = 1;
	else
		b.value = 0;
	placeVal /= 2;
}


If we didn't do this then we would have to use 8 different ids to refer to each of these 
8 buttons individually.

As the only other input we need to refer to is the decimal number input then we can just refer to by 
giving it its own unique id.

Suggested max % levels:
100% = works as shown here and all 
some attempt to convert in 1 direction
84% = 1 way conversion only.
94% = 2 way conversion but no & HTML JavaScript code restrictions
-->